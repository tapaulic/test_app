function querystring(t){for(var e,a=new RegExp("(?:\\?|&)"+t+"=(.*?)(?=&|$)","gi"),o=[];null!=(e=a.exec(document.location.search));)o.push(e[1]);return o}function changeFontSize(t,e){e?deleteCookie("fontsize"):setCookie("fontsize",t),$("body").css("font-size",t),$("#increaseFontSize")[0].disabled="1.5em"==t,$("#decreaseFontSize")[0].disabled=".7em"==t,$.isFunction(window.setPageTabHeight)&&setPageTabHeight(),setConsistentHeight(".tabNavigation",".nav-tabs a"),setConsistentHeight(".carousel",".item"),"undefined"!=typeof $gallery&&($gallery.flickity("resize"),setConsistentHeightHP(".r5",".linkBoxInside"))}function increaseFontSize(){var t=getCookie("fontsize")||"1.1em";changeFontSize(Math.min(parseFloat(t)+.1,1.5)+"em")}function decreaseFontSize(){var t=getCookie("fontsize")||".9em";changeFontSize(Math.max(parseFloat(t)-.1,.7)+"em")}function resetFontSize(){changeFontSize("1em",!0)}function applyFontSize(){var t=getCookie("fontsize");t&&changeFontSize(t)}function setCookie(t,e){var a=new Date;a.setTime(a.getTime()+864e5),document.cookie=t+"="+e+";path=/;expires="+a.toUTCString()}function getCookie(t){var e=document.cookie.match("(^|;) ?"+t+"=([^;]*)(;|$)");return e?e[2]:null}function deleteCookie(t){document.cookie=t+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;"}function gglTranslate(t){var e;e=""!=document.referrer?encodeURIComponent(document.referrer):"https%3a%2f%2fwww1.toronto.ca%2f",document.location.href="https://translate.google.com/translate?u="+e+"&sl=en&tl="+t+"&hl=en&ie=UTF-8"}function translatePage(){document.location.href="/wps/portal/contentonly?vgnextoid=4be8b9bd23805410VgnVCM10000071d60f89RCRD&vgnextchannel=8e79f9be8db1c310VgnVCM1000006cd60f89RCRD"}function setConsistentHeight(t,e){var a,o=$(t),n=[];o.each(function(){var t=$(this).find(e);t.length&&(t.each(function(){$(this).css("height","auto")}),t.each(function(){n.push($(this).height())}),a=Math.max.apply(null,n)+10,t.each(function(){$(this).css("height",a+"px")}))})}function dismissLD(){document.cookie="lddismiss=true; path=/"}function processLDResponse(t){if("Notice"==t.items.title){var e='<div class="modal fade" tabindex="-1" role="dialog" id="ldModal" style="z-index: 9999999;"><div class="modal-dialog"><div class="modal-content">';e+='<div class="modal-header">',e+='<h4 class="modal-title">'+t.items.title+'</h4></div><div class="modal-body"><p>'+t.items.summary+"</p></div>",e+='<div class="modal-footer" style="text-align: center;"><button onclick="dismissLD();" type="button" class="btn btn-primary" data-dismiss="modal">Continue</button>',e+="</div></div></div></div>",$("body").append(e),$(".modal a").css("text-decoration","underline"),$("#ldModal").modal({backdrop:!1})}}function formatDate(t){var e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=t.substring(0,4),o=t.substring(5,7),n=parseInt(t.substring(8,10));return e[parseInt(o)-1]+" "+n+", "+a}$(function(){if(""!=querystring("tab")&&$(".tabNavigation").length>0){$(".tabNavigation ul.nav li.active").removeClass("active"),$(".tabNavigation .tab-content .tab-pane.active").removeClass("active");var t=".tabNavigation ul.nav li:eq("+parseInt(querystring("tab"))+")";$(t).addClass("active"),t=".tabNavigation .tab-content .tab-pane:eq("+parseInt(querystring("tab"))+")",$(t).addClass("active")}});var cot_app=function(t,e){this.name=t,$.extend(this,{hasHeader:!0,hasFooter:!0,hasContentTop:!0,hasContentBottom:!0,hasContentRight:!0,hasContentLeft:!0,hasLeftNav:!1,searchcontext:"INTER"},e||{}),this.data={},this.forms={},this.breadcrumbItems=[],this.isRendered=!1};cot_app.prototype.setTitle=function(t){$("#app-header h1").html(t)},cot_app.prototype.setBreadcrumb=function(t,e){return this.breadcrumbItems=t,e||this.breadcrumbItems.push({name:this.name}),this._renderBreadcrumb(),this},cot_app.prototype._renderBreadcrumb=function(){var t=$("#app-breadcrumb");if(t.length)if(this.breadcrumbItems.length){var e="INTER"===this.searchcontext?"https://www1.toronto.ca":"http://insideto.toronto.ca",a="INTER"===this.searchcontext?"City of Toronto":"InsideTO",o='<li><a href="'+e+'"><span class="glyphicon glyphicon-home" style="margin-right: 5px;"></span>'+a+"</a></li>",n=this.breadcrumbItems.length-1;$.each(this.breadcrumbItems,function(t,e){if(e.name){var a=e.link&&t<n?'<a href="'+e.link+'">'+e.name+"</a>":e.name;o+="<li>"+a+"</li>"}}),t.find("ol.breadcrumb").html(o),t.show()}else t.hide()},cot_app.prototype.loadContent=function(t){var e=this;$.ajax({url:t.url,type:t.type?t.type:"GET",cache:t.cache?t.cache:"true",dataType:t.dataType?t.dataType:"jsonp",success:function(a){if(a=t.skiproot&&t.skiproot?a=a[0]:a,$.each(a.items,function(t,a){e.data[a.title]=a.summary}),!t.success)return e;t.success(a)},error:function(e,a,o){t.error?t.error():alert("Error: The application was unable to load data.")}})},cot_app.prototype.getTeaserModal=function(t){var e="";return t.title&&t.body?(e+="<p><button ",e+=t.btnclass?'class="'+t.btnclass+'" ':"",e+="onclick=\"$('#teaserModal').modal()\">"+t.title+"</button></p>",e+='<div class="modal fade" id="teaserModal" tabindex="-1" role="dialog" aria-labelledby="teaserModalLabel" aria-hidden="true">',e+='<div class="modal-dialog">',e+='<div class="modal-content">',e+='<div class="modal-header"><button class="close" type="button" data-dismiss="modal"> <span aria-hidden="true">&times;</span> <span class="sr-only">Close</span></button>',e+='<h2 id="teaserModalLabel" class="modal-title">'+t.title+"</h2>",e+="</div>",e+='<div id="teaserModalBody" class="modal-body">'+t.body+"</div>",e+='<div class="modal-footer">',e+='<button class="btn btn-default" type="button" data-dismiss="modal">Close</button>',e+="</div></div></div></div>"):e+="<p class='hasError'>Error!</p>",e},cot_app.prototype.getTeaserStandard=function(t){var e="";return t.modal?e+=t.modal&&t.title&&t.body?this.getModalHTML(t.title,t.body):"":(e+=t.title?"<div class='componentTitle'><h2>"+t.title+"</h2></div>":"",e+=t.body?"<div class='article media componentBody'>"+t.body+"</div>":""),e},cot_app.prototype.render=function(t){if(this.isRendered)throw new Error("App is already rendered");var e=document.createElement("div");e.id="appDisplay",$("#appDisplay").addClass("hide"),$("body").append(e);var a=this;return $("#appDisplay").load("html/cot_template_page.html #cot-template-page",function(e,o,n){switch(a.setTitle(a.name),a._renderBreadcrumb(),a.searchcontext){case"INTRA":$("#siteSearchGSA").attr("action","http://insideto-search.toronto.ca/search"),$("#siteSearchGSA #q").attr("placeholder","Search Inside Toronto..."),$("#sf_client").val("insideto-search"),$("#sf_proxystylesheet").val("insideto-search"),$("#sf_site").val("InsideTO-All"),$(".sf_311").remove();break;case"311":$("#siteSearchGSA").attr("action","http://insideto-search.toronto.ca/search"),$("#siteSearchGSA #q").attr("placeholder","Search the 311 Knowledge Base..."),$("#sf_client").val("311KBSTAFF"),$("#sf_proxystylesheet").val("311KBSTAFF"),$("#sf_site").val("311KB");break;default:$("#siteSearchGSA").attr("action","http://search.toronto.ca/search"),$("#siteSearchGSA #q").attr("placeholder",""),$("#sf_client").val("Toronto"),$("#sf_proxystylesheet").val("_common_"),$("#sf_site").val("TorontoWebsite"),$(".sf_311").remove()}a.hasLeftNav?($("#app-nav-left").removeClass("hide"),$("#app-content-full").addClass("col-sm-9")):$("#app-nav-left").remove(),a.hasHeader||($("#cot-header").remove(),$("#app-header").remove()),a.hasFooter||$("#app-footer").remove(),a.hasContentTop||$("#app-content-top").remove(),a.hasContentRight||($("#app-content-left").removeClass("col-md-8"),$("#app-content-right").remove()),a.hasContentLeft||$("#app-content-left").remove(),a.hasContentBottom||$("#app-content-bottom").remove(),applyFontSize(),$("#appDisplay").removeClass("hide"),a.isRendered=!0,t()}),this},cot_app.prototype.showTerms=function(t,e,a,o,n,s){var i=this,r=arguments;"agree"!=getCookie(a)?$(o).load("html/cot_template_terms.html #cot-template-terms",function(c,l,d){var p=s||"Terms of Use Agreement";$("#cot-terms-title h2").html(p),$("#cot-terms-body").html(t),$("#cot-terms-agree").click(function(){setCookie(a,"agree"),n()}),$("#cot-terms-disagree").click(function(){$(o).load("html/cot_template_terms.html #cot-template-terms-disagree",function(t,a,o){$("#cot-terms-return").text(p).click(function(){i.showTerms.apply(i,r)}),$("#cot-terms-homepage").click(function(){document.location="https://web.toronto.ca"}),$("#cot-terms-body").html(e),$("#cot-terms").removeClass("hide")})}),$("#cot-terms").removeClass("hide")}):n()},cot_app.prototype.setNOC=function(t){$("#nocModalBody").html(t)},cot_app.prototype.showNOC=function(){$("#nocModal").modal()},cot_app.prototype.setContent=function(t){var e=this;$.each(["top","right","bottom","left","nav"],function(a,o){void 0!==t[o]&&$(e.getContentContainerSelector(o)).html(t[o])})},cot_app.prototype.addForm=function(t,e,a){if(a=void 0===a||a){var o={};o[e]="",this.setContent(o)}t.render({target:this.getContentContainerSelector(e)})},cot_app.prototype.getContentContainerSelector=function(t){return"nav"==t?"#app-nav-left":"#app-content-"+t};